<?php $this->addCss('/plugins/demo/core/controllers/baseenginecontroller/assets/css/engine.css') ?>
<?php $this->addJs('/plugins/demo/core/controllers/baseenginecontroller/assets/js/engine.js') ?>
<?php $this->addJs('/plugins/demo/core/controllers/baseenginecontroller/assets/js/engine.ui.js') ?>
<div class="engine-list-wrapper">
    <?php if ($toolbar): ?>
        <div class="engine-list-toolbar">
            <?= $toolbar->render() ?>
            <div class="engine-actions">

            </div>
        </div>
    <?php endif ?>

    <?php if ($filter): ?>
        <div class="engine-list-filter">
            <?= $filter->render() ?>
        </div>
    <?php endif ?>

    <div class="row row-flush">
        <div class="col-sm-0">
        </div>
        <div class="col-sm-12 list-with-sidebar">
            <div class="engine-list-content">
                <?= $list->render() ?>
            </div>
        </div>
    </div>
    <?php
    $listActions = $this->getListActions();
    $modelRecord = $this->getModelRecord();
    ?>
    <script>
        $(document).ready(function() {
            window.me = {id:<?=$this->user->id?>};
            $('.engine-list-wrapper .toolbar-primary .btn').remove(); // removing cms buttons
            var actions = <?=$listActions ? $listActions->toJSON() : '[]'?>;
            var modelRecord = <?=$modelRecord ? $modelRecord->toJSON() : 'null'?>;
            var controller = <?=json_encode($this->getControllerInfo())?>;
            Engine.instance.ui.setModel(modelRecord);
            var list = EngineList.getCurrentList();
            list.setPagination(<?= json_encode([
                    'from' => $list->vars['pageFrom'],
                    'to' => $list->vars['pageTo'],
                    'total' => $list->vars['recordTotal']
                ])
                ?>);
            list.addActions(actions);
        });
    </script>
</div>